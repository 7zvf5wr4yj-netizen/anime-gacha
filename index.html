<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Reseit RNG: Full Edition</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #030308;
      --card-bg: rgba(15, 15, 25, 0.8);
      --neon-blue: #00f3ff;
      --neon-purple: #bc00ff;
      --neon-gold: #ffcc00;
      --neon-red: #ff004c;
    }

    body {
      background-color: var(--bg);
      color: #fff;
      font-family: 'Rajdhani', sans-serif;
      margin: 0; padding: 0;
      overflow: hidden;
      height: 100vh;
    }

    .bg-animation {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: radial-gradient(circle at center, #11112b 0%, #030308 100%);
      z-index: -1;
    }

    .app-container {
      display: flex; flex-direction: column; height: 100vh;
      padding: 20px; box-sizing: border-box;
    }

    /* –í–ï–†–•–ù–Ø–Ø –ü–ê–ù–ï–õ–¨ –ò–ó –ü–ê–ô–¢–û–ù –ë–û–¢–ê */
    .top-nav {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      background: var(--card-bg);
      padding: 12px; border-radius: 12px;
      border: 1px solid rgba(0, 243, 255, 0.2);
      backdrop-filter: blur(15px);
      font-family: 'Orbitron';
    }

    .stat-box { text-align: center; }
    .stat-label { font-size: 9px; opacity: 0.6; text-transform: uppercase; }
    .stat-val { font-size: 14px; font-weight: bold; color: var(--neon-blue); }

    /* –ó–û–ù–ê –ü–†–ò–ó–´–í–ê (SOLS RNG STYLE) */
    .roll-area {
      flex-grow: 1;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      position: relative;
    }

    #chance-text {
      font-family: 'Orbitron'; font-size: 11px;
      letter-spacing: 3px; color: rgba(255,255,255,0.3);
      margin-bottom: 15px;
    }

    .hero-display { text-align: center; min-height: 120px; }
    .hero-name {
      font-size: 52px; font-weight: 800; text-transform: uppercase;
      margin: 0; line-height: 0.9; letter-spacing: -2px;
      transition: all 0.2s ease-out;
    }
    .rarity-tag {
      display: inline-block; padding: 2px 10px;
      border-radius: 4px; font-family: 'Orbitron';
      font-size: 12px; margin-top: 10px;
    }

    /* –ö–ù–û–ü–ö–ò –ú–ï–ù–Æ */
    .bottom-controls {
      display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;
    }

    .main-btn {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      color: white; padding: 15px; border-radius: 8px;
      font-family: 'Orbitron'; font-size: 12px;
      transition: 0.2s; cursor: pointer;
    }

    .roll-btn {
      grid-column: span 2;
      background: linear-gradient(180deg, rgba(0, 243, 255, 0.2), transparent);
      border: 1px solid var(--neon-blue);
      font-size: 24px; font-weight: 900;
      box-shadow: 0 0 15px rgba(0, 243, 255, 0.2);
    }

    .roll-btn:active { transform: scale(0.95); box-shadow: 0 0 30px var(--neon-blue); }

    /* –ê–ù–ò–ú–ê–¶–ò–ò –†–ï–î–ö–û–°–¢–ï–ô */
    .rarity-COMMON { color: #888; }
    .rarity-RARE { color: var(--neon-blue); text-shadow: 0 0 10px var(--neon-blue); }
    .rarity-EPIC { color: var(--neon-purple); text-shadow: 0 0 15px var(--neon-purple); }
    .rarity-LEGENDARY { color: var(--neon-gold); text-shadow: 0 0 25px var(--neon-gold); animation: pulse 1s infinite alternate; }
    .rarity-MYTHIC { color: var(--neon-red); text-shadow: 0 0 30px var(--neon-red); animation: shake 0.1s infinite; }
    .rarity-DIVINE {
      background: linear-gradient(90deg, #ff00cc, #3333ff, #13ff62, #ffcc00);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      animation: divineFlow 3s infinite linear;
    }

    @keyframes pulse { from { transform: scale(1); } to { transform: scale(1.05); } }
    @keyframes shake { 0% { transform: translate(1px, 1px); } 50% { transform: translate(-1px, -1px); } 100% { transform: translate(1px, -1px); } }
    @keyframes divineFlow { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }

    .shake-screen { animation: screenShake 0.2s infinite; }
    @keyframes screenShake { 0% { transform: translate(2px, 2px); } 50% { transform: translate(-2px, -3px); } 100% { transform: translate(2px, -1px); } }
  </style>
</head>
<body>
  <div class="bg-animation"></div>
  
  <div class="app-container">
    <div class="top-nav">
      <div class="stat-box">
        <div class="stat-label">Diamonds</div>
        <div class="stat-val" id="dmd">0</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Power</div>
        <div class="stat-val" id="pwr">0</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Tickets</div>
        <div class="stat-val" id="tix">0</div>
      </div>
    </div>

    <div class="roll-area" id="main-screen">
      <div id="chance-text">READY TO EVOLVE</div>
      <div class="hero-display">
        <div id="res-name" class="hero-name">? ? ?</div>
        <div id="res-tag" class="rarity-tag" style="display:none;"></div>
      </div>
    </div>

    <div class="bottom-controls">
      <button class="main-btn roll-btn" onclick="roll()">ROLL</button>
      <button class="main-btn" onclick="openShop()">üõçÔ∏è SHOP</button>
      <button class="main-btn" onclick="startBattle()">‚öîÔ∏è PVP ARENA</button>
    </div>
  </div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    // –ü–ï–†–ï–ù–ï–°–ï–ù–ù–ê–Ø –ë–ê–ó–ê –ì–ï–†–û–ï–í
    const HEROES = [
      { n: "Slime", c: 2, r: "COMMON" },
      { n: "Ninja", c: 10, r: "RARE" },
      { n: "Ichigo", c: 50, r: "RARE" },
      { n: "Naruto", c: 250, r: "EPIC" },
      { n: "Gojo", c: 1000, r: "LEGENDARY" },
      { n: "Sukuna", c: 5000, r: "LEGENDARY" },
      { n: "Saitama", c: 50000, r: "MYTHIC" },
      { n: "Madara", c: 250000, r: "MYTHIC" },
      { n: "Jin-Woo", c: 1000000, r: "DIVINE" }
    ];

    // –ü–ï–†–ï–ù–ï–°–ï–ù–ù–ê–Ø –ë–ê–ó–ê –ë–û–°–°–û–í
    const BOSSES = [
      { name: "–°–£–ö–£–ù–ê", base: 15000, dmd: 500 },
      { name: "–ú–ê–î–ê–†–ê", base: 50000, dmd: 2000 },
      { name: "–ê–ô–ó–ï–ù", base: 150000, dmd: 10000 }
    ];

    let state = JSON.parse(localStorage.getItem('reseit_full_v4')) || {
      dmd: 1000,
      pwr: 0,
      tix: 5,
      wins: 0
    };

    function updateUI() {
      document.getElementById('dmd').innerText = state.dmd.toLocaleString();
      document.getElementById('pwr').innerText = state.pwr.toLocaleString();
      document.getElementById('tix').innerText = state.tix;
      localStorage.setItem('reseit_full_v4', JSON.stringify(state));
    }

    // –õ–û–ì–ò–ö–ê –ü–†–ò–ó–´–í–ê (RNG)
    function roll() {
      if(state.dmd < 10) { tg.showAlert("‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∞–ª–º–∞–∑–æ–≤!"); return; }
      state.dmd -= 10;
      updateUI();

      const screen = document.getElementById('main-screen');
      const nameEl = document.getElementById('res-name');
      const tagEl = document.getElementById('res-tag');
      const chanceEl = document.getElementById('chance-text');

      screen.classList.add('shake-screen');
      nameEl.innerText = "ROLLING...";
      nameEl.className = "hero-name";
      tagEl.style.display = "none";
      tg.HapticFeedback.impactOccurred('medium');

      setTimeout(() => {
        screen.classList.remove('shake-screen');
        let rolled = HEROES[0];
        let rand = Math.random();
        for(let h of [...HEROES].reverse()) {
          if(Math.random() < (1/h.c)) { rolled = h; break; }
        }

        nameEl.innerText = rolled.n;
        nameEl.className = `hero-name rarity-${rolled.r}`;
        tagEl.innerText = rolled.r;
        tagEl.className = `rarity-tag rarity-${rolled.r}`;
        tagEl.style.display = "inline-block";
        chanceEl.innerText = `LUCK: 1 –∫ ${rolled.c.toLocaleString()}`;

        if(rolled.c >= 1000) tg.HapticFeedback.notificationOccurred('success');
        
        state.pwr += Math.floor(rolled.c / 10);
        updateUI();
      }, 700);
    }

    // –ì–ï–ù–ï–†–ê–¢–û–† –ò–ú–ï–ù (–ò–ó –¢–í–û–ï–ì–û –ü–ê–ô–¢–û–ù –ë–û–¢–ê)
    function genName() {
      const p = ["Pro", "Shadow", "Dark", "Fire", "Alpha"];
      const s = ["Gamer", "King", "Warrior", "Slayer", "Legend"];
      return p[Math.floor(Math.random()*p.length)] + "_" + s[Math.floor(Math.random()*s.length)];
    }

    // –ü–í–ü –ò –ë–û–°–°–´ (–ò–ó –¢–í–û–ï–ì–û –ü–ê–ô–¢–û–ù –ë–û–¢–ê)
    function startBattle() {
      if(state.tix < 1) { tg.showAlert("üé´ –ù—É–∂–Ω—ã —Ç–∏–∫–µ—Ç—ã! –ö—É–ø–∏ –∏—Ö –≤ –º–∞–≥–∞–∑–∏–Ω–µ."); return; }
      
      const isBoss = Math.random() < 0.3;
      const oppName = isBoss ? BOSSES[Math.floor(Math.random()*BOSSES.length)].name : genName();
      const oppBasePower = isBoss ? BOSSES[0].base : state.pwr;
      const oppPower = Math.floor(oppBasePower * (0.8 + Math.random() * 0.4));
      const tactic = ["–∞–≥—Ä–µ—Å—Å–∏–≤–Ω—É—é", "–∑–∞—â–∏—Ç–Ω—É—é", "—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é"][Math.floor(Math.random()*3)];

      tg.showConfirm(`–í—ã–∑–≤–∞—Ç—å –Ω–∞ –±–æ–π: ${oppName}?\n–°–∏–ª–∞ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞: ~${oppPower.toLocaleString()}`, (ok) => {
        if(!ok) return;
        state.tix--;
        
        if(state.pwr > oppPower * 0.85) {
          const reward = isBoss ? 1000 : 200;
          state.dmd += reward;
          state.wins++;
          // –®–∞–Ω—Å –≤–µ—Ä–Ω—É—Ç—å —Ç–∏–∫–µ—Ç (30%)
          if(Math.random() < 0.3) {
             state.tix++;
             tg.showAlert(`üèÜ –ü–û–ë–ï–î–ê!\n–¢—ã –æ–¥–æ–ª–µ–ª ${oppName}!\n–ù–∞–≥—Ä–∞–¥–∞: ${reward} üíé –∏ –≤–æ–∑–≤—Ä–∞—Ç —Ç–∏–∫–µ—Ç–∞!`);
          } else {
             tg.showAlert(`üèÜ –ü–û–ë–ï–î–ê!\n–¢—ã –æ–¥–æ–ª–µ–ª ${oppName}!\n–ù–∞–≥—Ä–∞–¥–∞: ${reward} üíé\n–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª ${tactic} —Ç–∞–∫—Ç–∏–∫—É.`);
          }
        } else {
          tg.showAlert(`üòî –ü–û–†–ê–ñ–ï–ù–ò–ï\n${oppName} –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω–µ–µ.\n–¢–≤–æ—è —Å–∏–ª–∞: ${state.pwr}\n–°–∏–ª–∞ –≤—Ä–∞–≥–∞: ${oppPower}`);
        }
        updateUI();
      });
    }

    function openShop() {
      tg.showConfirm("–ö–£–ü–ò–¢–¨ –ü–ê–ö–ï–¢ –¢–ò–ö–ï–¢–û–í?\n5 —à—Ç—É–∫ –∑–∞ 500 üíé", (ok) => {
        if(ok) {
          if(state.dmd >= 500) {
            state.dmd -= 500; state.tix += 5; updateUI();
            tg.showAlert("‚úÖ –ö—É–ø–ª–µ–Ω–æ!");
          } else {
            tg.showAlert("‚ùå –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –∞–ª–º–∞–∑–æ–≤!");
          }
        }
      });
    }

    updateUI();
  </script>
</body>
</html>
