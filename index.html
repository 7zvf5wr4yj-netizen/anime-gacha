<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>CR: Nuclear Analyzer 6.0</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    :root { --bg: #030712; --accent: #00f2ff; --glass: rgba(255, 255, 255, 0.03); --border: rgba(255, 255, 255, 0.08); }
    body { background: var(--bg); color: #fff; font-family: 'Outfit', sans-serif; margin: 0; padding: 0; overflow: hidden; }
    .app { display: flex; flex-direction: column; height: 100vh; max-width: 500px; margin: 0 auto; background: radial-gradient(circle at 50% 0%, #111827 0%, #030712 100%); }
    
    .header { padding: 15px; text-align: center; }
    .header h1 { margin: 0; font-size: 20px; font-weight: 900; letter-spacing: 1px; color: var(--accent); text-transform: uppercase; }
    
    /* GRID */
    .deck-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; padding: 10px 15px; }
    .slot { aspect-ratio: 1/1.25; background: var(--glass); border: 1px solid var(--border); border-radius: 12px; display: flex; align-items: center; justify-content: center; position: relative; cursor: pointer; transition: 0.2s; }
    .slot.filled { border-color: var(--accent); box-shadow: 0 0 15px rgba(0, 242, 255, 0.1); }
    .slot img { width: 90%; height: 90%; object-fit: contain; display: none; }
    .slot.filled img { display: block; animation: pop 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); }
    .elixir-badge { position: absolute; top: -5px; right: -5px; background: #f0f; border-radius: 6px; width: 18px; height: 18px; font-size: 10px; font-weight: 900; display: none; align-items: center; justify-content: center; border: 1px solid #fff; }
    .slot.filled .elixir-badge { display: flex; }

    /* STATS */
    .stats-container { padding: 0 20px; margin-top: 10px; }
    .stat-row { margin-bottom: 8px; }
    .stat-label { display: flex; justify-content: space-between; font-size: 10px; text-transform: uppercase; margin-bottom: 3px; opacity: 0.7; }
    .bar-bg { background: rgba(255,255,255,0.05); height: 4px; border-radius: 2px; overflow: hidden; }
    .bar-fill { height: 100%; background: var(--accent); width: 0%; transition: 1s ease-out; }

    /* MODALS */
    .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.96); z-index: 1000; display: none; flex-direction: column; }
    .modal-content { margin-top: auto; background: #0f172a; border-top: 2px solid var(--accent); border-radius: 25px 25px 0 0; height: 85vh; display: flex; flex-direction: column; }
    #search { width: 90%; margin: 15px auto; background: #1e293b; border: 1px solid var(--border); padding: 12px; border-radius: 12px; color: #fff; outline: none; }
    .cards-list { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 15px; overflow-y: auto; }
    .card-item img { width: 100%; border-radius: 8px; }

    .btn-main { width: 90%; margin: 20px auto; padding: 18px; border-radius: 16px; border: none; background: linear-gradient(90deg, #3b82f6, var(--accent)); color: #fff; font-weight: 900; text-transform: uppercase; cursor: pointer; }

    /* RESULT */
    .result-view { position: fixed; inset: 0; background: var(--bg); z-index: 3000; display: none; flex-direction: column; align-items: center; justify-content: center; padding: 20px; overflow-y: auto; }
    .res-card { background: var(--glass); border: 1px solid var(--border); padding: 25px; border-radius: 25px; width: 100%; box-sizing: border-box; }
    
    .sheet { position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 2000; display: none; align-items: flex-end; }
    .sheet-body { background: #1e293b; width: 100%; border-radius: 20px 20px 0 0; padding: 20px; box-sizing: border-box; }
  </style>
</head>
<body>

<div class="app">
  <div class="header"><h1>DECK ANALYST 6.0</h1></div>
  
  <div class="deck-grid">
    <script>
      for(let i=0; i<8; i++) document.write(`<div class="slot" id="s${i}" onclick="handleSlotClick(${i})"><span style="opacity:0.1">Ôºã</span><div class="elixir-badge" id="e${i}"></div><img id="img${i}"></div>`);
    </script>
  </div>

  <div class="stats-container" id="live-stats">
    <div class="stat-row"><div class="stat-label"><span>–ê—Ç–∞–∫–∞</span><span id="v-atk">0%</span></div><div class="bar-bg"><div class="bar-fill" id="b-atk"></div></div></div>
    <div class="stat-row"><div class="stat-label"><span>–ó–∞—â–∏—Ç–∞</span><span id="v-def">0%</span></div><div class="bar-bg"><div class="bar-fill" id="b-def"></div></div></div>
    <div class="stat-row"><div class="stat-label"><span>–°–∏–Ω–µ—Ä–≥–∏—è</span><span id="v-syn">0%</span></div><div class="bar-bg"><div class="bar-fill" id="b-syn"></div></div></div>
    <div class="stat-row"><div class="stat-label"><span>F2P Score</span><span id="v-f2p">0%</span></div><div class="bar-bg"><div class="bar-fill" id="b-f2p"></div></div></div>
  </div>

  <button class="btn-main" onclick="analyze()">–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑</button>
</div>

<div id="modal" class="modal" onclick="closeModal()"><div class="modal-content" onclick="event.stopPropagation()"><input type="text" id="search" placeholder="–ü–æ–∏—Å–∫ –∫–∞—Ä—Ç—ã..." oninput="renderCards()"><div class="cards-list" id="card-list"></div></div></div>
<div id="sheet" class="sheet" onclick="closeSheet()"><div class="sheet-body" onclick="event.stopPropagation()"><button class="btn-main" style="margin:5px 0" onclick="openPicker(lastIdx)">–ó–∞–º–µ–Ω–∏—Ç—å</button><button class="btn-main" style="margin:5px 0; background:#ef4444" onclick="removeCard()">–£–¥–∞–ª–∏—Ç—å</button></div></div>

<div id="result" class="result-view">
  <div id="res-grid" style="display:grid; grid-template-columns:repeat(4,1fr); gap:10px; margin-bottom:20px; width:100%"></div>
  <div class="res-card">
    <div id="res-emoji" style="font-size:50px; margin-bottom:10px; text-align:center"></div>
    <h2 id="res-title" style="color:var(--accent); text-align:center; margin:0"></h2>
    <p id="res-text" style="font-size:14px; line-height:1.6; text-align:center; opacity:0.9"></p>
  </div>
  <button class="btn-main" onclick="location.reload()">–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å</button>
</div>

<script>
const tg = window.Telegram.WebApp; tg.expand();

// –ë–ê–ó–ê –ö–ê–†–¢ –° –¢–ï–ì–ê–ú–ò (115+ –ö–ê–†–¢)
const CARDS = [
  {id:"hog-rider",n:"–•–æ–≥",e:4,r:2,role:"win",tags:["ground"]}, {id:"balloon",n:"–®–∞—Ä",e:5,r:3,role:"win",tags:["air"]},
  {id:"goblin-barrel",n:"–ë–æ—á–∫–∞",e:3,r:3,role:"win",tags:["swarm"]}, {id:"mega-knight",n:"–ú–ö",e:7,r:4,role:"def",tags:["splash","ground"]},
  {id:"pekka",n:"–ü–ï–ö–ö–ê",e:7,r:3,role:"def",tags:["heavy","ground"]}, {id:"the-log",n:"–ë—Ä–µ–≤–Ω–æ",e:2,r:4,role:"spell",tags:["small"]},
  {id:"fireball",n:"–§–∞–π–µ—Ä",e:4,r:2,role:"spell",tags:["big"]}, {id:"arrows",n:"–°—Ç—Ä–µ–ª—ã",e:3,r:1,role:"spell",tags:["small"]},
  {id:"zap",n:"–†–∞–∑—Ä—è–¥",e:2,r:1,role:"spell",tags:["small"]}, {id:"poison",n:"–Ø–¥",e:4,r:3,role:"spell",tags:["big"]},
  {id:"valkyrie",n:"–í–∞–ª—å–∫–∞",e:4,r:2,role:"def",tags:["splash"]}, {id:"knight",n:"–†—ã—Ü–∞—Ä—å",e:3,r:1,role:"def",tags:["ground"]},
  {id:"giant",n:"–ì–∏–≥–∞–Ω—Ç",e:5,r:2,role:"win",tags:["heavy"]}, {id:"royal-giant",n:"–ö–ì",e:6,r:1,role:"win",tags:["heavy"]},
  {id:"electro-giant",n:"–≠–ì",e:7,r:3,role:"win",tags:["heavy"]}, {id:"x-bow",n:"–ê—Ä–±–∞–ª–µ—Ç",e:6,r:3,role:"win",tags:["building","toxic"]},
  {id:"mortar",n:"–ú–æ—Ä—Ç–∏—Ä–∞",e:4,r:1,role:"win",tags:["building"]}, {id:"miner",n:"–®–∞—Ö—Ç–µ—Ä",e:3,r:4,role:"win",tags:["cycle"]},
  {id:"little-prince",n:"–ü—Ä–∏–Ω—Ü",e:3,r:5,role:"sup",tags:["ranged"]}, {id:"monk",n:"–ú–æ–Ω–∞—Ö",e:5,r:5,role:"def",tags:["ground"]},
  {id:"skeletons",n:"–°–∫–µ–ª–µ—Ç—ã",e:1,r:1,role:"cycle",tags:["swarm"]}, {id:"ice-spirit",n:"–î—É—Ö",e:1,r:1,role:"cycle",tags:["small"]},
  {id:"inferno-tower",n:"–ò–Ω—Ñ–µ—Ä–Ω–æ",e:5,r:2,role:"def",tags:["building"]}, {id:"cannon",n:"–ü—É—à–∫–∞",e:3,r:1,role:"def",tags:["building"]},
  {id:"tesla",n:"–¢–µ—Å–ª–∞",e:4,r:1,role:"def",tags:["building"]}, {id:"graveyard",n:"–ö–ª–∞–¥–±–∏—â–µ",e:5,r:4,role:"win",tags:["swarm"]},
  {id:"sparky",n:"–°–ø–∞—Ä–∫–∏",e:6,r:4,role:"win",tags:["splash","heavy"]}, {id:"bandit",n:"–ë–∞–Ω–¥–∏—Ç–∫–∞",e:3,r:4,role:"sup",tags:["ground"]},
  {id:"royal-ghost",n:"–ü—Ä–∏–∑—Ä–∞–∫",e:3,r:4,role:"sup",tags:["splash"]}, {id:"night-witch",n:"–í–µ–¥—å–º–∞",e:4,r:4,role:"sup",tags:["ground"]},
  {id:"phoenix",n:"–§–µ–Ω–∏–∫—Å",e:4,r:4,role:"sup",tags:["air"]}, {id:"electro-wizard",n:"–≠–ª–µ–∫—Ç—Ä–æ–º–∞–≥",e:4,r:4,role:"sup",tags:["ranged"]},
  {id:"executioner",n:"–ü–∞–ª–∞—á",e:5,r:3,role:"def",tags:["splash"]}, {id:"bowler",n:"–í—ã—à–∏–±–∞–ª–∞",e:5,r:3,role:"def",tags:["splash"]},
  {id:"lumberjack",n:"–î—Ä–æ–≤–æ—Å–µ–∫",e:4,r:4,role:"heavy",tags:["ground"]}, {id:"freeze",n:"–§—Ä–∏–∑",e:4,r:3,role:"spell",tags:["toxic"]},
  {id:"clone",n:"–ö–ª–æ–Ω",e:3,r:3,role:"spell",tags:["toxic"]}, {id:"mirror",n:"–ó–µ—Ä–∫–∞–ª–æ",e:0,r:3,role:"spell",tags:["toxic"]},
  {id:"elite-barbarians",n:"–≠–ª–∏—Ç–∫–∏",e:6,r:1,role:"heavy",tags:["ground"]}, {id:"rocket",n:"–†–∞–∫–µ—Ç–∞",e:6,r:2,role:"spell",tags:["big"]},
  {id:"firecracker",n:"–õ—É—á–∏—Ü–∞",e:3,r:1,role:"sup",tags:["splash","ranged"]}, {id:"bats",n:"–ú—ã—à–∏",e:2,r:1,role:"cycle",tags:["air","swarm"]},
  {id:"electro-spirit",n:"–≠–ª–µ–∫—Ç—Ä–æ–¥—É—Ö",e:1,r:1,role:"cycle",tags:["small"]}, {id:"golden-knight",n:"–ó–æ–ª–†—ã—Ü–∞—Ä—å",e:4,r:5,role:"def",tags:["ground"]},
  {id:"archer-queen",n:"–ö–æ—Ä–æ–ª–µ–≤–∞",e:5,r:5,role:"sup",tags:["ranged"]}, {id:"skeleton-king",n:"–ö–æ—Ä–°–∫–µ–ª–µ—Ç",e:4,r:5,role:"def",tags:["splash"]},
  {id:"mighty-miner",n:"–ú–æ–≥–®–∞—Ö—Ç–µ—Ä",e:4,r:5,role:"def",tags:["heavy"]}, {id:"ram-rider",n:"–í—Å–∞–¥–Ω–∏—Ü–∞",e:5,r:4,role:"win",tags:["ground"]},
  {id:"battle-ram",n:"–¢–∞—Ä–∞–Ω",e:4,r:2,role:"win",tags:["ground"]}, {id:"royal-hogs",n:"–ö–∞–±–∞–Ω—ã",e:5,r:2,role:"win",tags:["swarm"]},
  {id:"mother-witch",n:"–ú–∞—Ç—å–í–µ–¥—å–º–∞",e:4,r:4,role:"sup",tags:["ranged"]}, {id:"fisherman",n:"–†—ã–±–∞–∫",e:3,r:4,role:"def",tags:["ground"]},
  {id:"zappies",n:"–ú–∞—à–∏–Ω–∫–∏",e:4,r:2,role:"def",tags:["ranged"]}, {id:"flying-machine",n:"–õ–µ—Ç–∞–ª–∫–∞",e:4,r:2,role:"sup",tags:["air","ranged"]},
  {id:"baby-dragon",n:"–î—Ä–∞–∫–æ—à–∞",e:4,r:3,role:"sup",tags:["air","splash"]}, {id:"inferno-dragon",n:"–ü–ª–∞–º–µ–Ω–Ω—ã–π",e:4,r:4,role:"def",tags:["air","heavy"]},
  {id:"magic-archer",n:"–ú–∞–≥–õ—É—á–Ω–∏–∫",e:4,r:4,role:"sup",tags:["ranged"]}, {id:"dark-prince",n:"–¢–µ–º–Ω—ã–π–ü—Ä–∏–Ω—Ü",e:4,r:3,role:"def",tags:["splash"]},
  {id:"prince",n:"–ü—Ä–∏–Ω—Ü",e:5,r:3,role:"heavy",tags:["ground"]}, {id:"mini-pekka",n:"–ú–∏–Ω–∏–∫",e:4,r:2,role:"heavy",tags:["ground"]},
  {id:"hunter",n:"–û—Ö–æ—Ç–Ω–∏–∫",e:4,r:2,role:"def",tags:["ranged"]}, {id:"royal-recruits",n:"–†–µ–∫—Ä—É—Ç—ã",e:7,r:1,role:"def",tags:["swarm"]},
  {id:"skeleton-army",n:"–°–∫–µ–º–∏—è",e:3,r:3,role:"def",tags:["swarm"]}, {id:"guards",n:"–°—Ç—Ä–∞–∂–∏",e:3,r:3,role:"def",tags:["swarm"]},
  {id:"minions",n:"–ú–∏–Ω—å–æ–Ω—ã",e:3,r:1,role:"sup",tags:["air"]}, {id:"minion-horde",n:"–û—Ä–¥–∞",e:5,r:1,role:"def",tags:["air","swarm"]},
  {id:"goblin-gang",n:"–ë–∞–Ω–¥–∞",e:3,r:1,role:"def",tags:["swarm"]}, {id:"wizard",n:"–ú–∞–≥",e:5,r:2,role:"sup",tags:["splash"]},
  {id:"ice-wizard",n:"–õ–µ–¥—è–Ω–æ–π",e:3,r:4,role:"sup",tags:["splash"]}, {id:"witch",n:"–í–µ–¥—å–º–∞",e:5,r:3,role:"sup",tags:["splash","swarm"]},
  {id:"cannon-cart",n:"–¢–µ–ª–µ–∂–∫–∞",e:5,r:3,role:"sup",tags:["ground"]}, {id:"barbarian-barrel",n:"–ë–æ—á–∫–∞–í–∞—Ä",e:2,r:2,role:"spell",tags:["small"]},
  {id:"earthquake",n:"–ó–µ–º–ª—è",e:3,r:2,role:"spell",tags:["big"]}, {id:"tornado",n:"–¢–æ—Ä–Ω–∞–¥–æ",e:3,r:3,role:"spell",tags:["small"]},
  {id:"lightning",n:"–ú–æ–ª–Ω–∏—è",e:6,r:3,role:"spell",tags:["big"]}, {id:"bomb-tower",n:"–ë–æ–º–±–µ–∂–∫–∞",e:4,r:2,role:"def",tags:["building"]},
  {id:"furnace",n:"–ü–µ—á–∫–∞",e:4,r:2,role:"def",tags:["building"]}, {id:"goblin-cage",n:"–ö–ª–µ—Ç–∫–∞",e:4,r:2,role:"def",tags:["building"]},
  {id:"elixir-collector",n:"–°–±–æ—Ä—â–∏–∫",e:6,r:2,role:"sup",tags:["building"]}, {id:"barbarians",n:"–í–∞—Ä–≤–∞—Ä—ã",e:5,r:1,role:"def",tags:["swarm"]},
  {id:"minion-horde",n:"–û—Ä–¥–∞",e:5,r:1,role:"def",tags:["air","swarm"]}, {id:"three-musketeers",n:"3–ú—É—à–∫–µ—Ç–∞",e:9,r:2,role:"win",tags:["heavy"]},
  {id:"wall-breakers",n:"–°—Ç–µ–Ω–æ–±–æ–∏",e:2,r:3,role:"win",tags:["cycle"]}, {id:"goblin-drill",n:"–ë—É—Ä",e:4,r:3,role:"win",tags:["building"]},
  {id:"skeleton-barrel",n:"–ë–æ—á–∫–∞–°–∫–µ–ª",e:3,r:1,role:"win",tags:["air","swarm"]}
];

let deck = Array(8).fill(null);
let lastIdx = 0;

function handleSlotClick(i) { lastIdx = i; if(deck[i]) document.getElementById('sheet').style.display='flex'; else openPicker(i); }
function openPicker(i) { lastIdx=i; closeSheet(); document.getElementById('modal').style.display='flex'; renderCards(); }
function closeModal() { document.getElementById('modal').style.display='none'; }
function closeSheet() { document.getElementById('sheet').style.display='none'; }

function removeCard() { 
  deck[lastIdx]=null; 
  document.getElementById(`s${lastIdx}`).classList.remove('filled');
  updateStats(); closeSheet(); 
}

function renderCards() {
  const q = document.getElementById('search').value.toLowerCase();
  const used = deck.filter(c => c).map(c => c.id);
  document.getElementById('card-list').innerHTML = CARDS.filter(c => c.n.toLowerCase().includes(q))
    .map(c => `<div class="card-item ${used.includes(c.id)?'opacity-20':''}" onclick="selectCard('${c.id}')"><img src="https://royaleapi.github.io/cr-api-assets/cards/${c.id}.png"></div>`).join('');
}

function selectCard(id) {
  const card = CARDS.find(c => c.id === id);
  deck[lastIdx] = card;
  const s = document.getElementById(`s${lastIdx}`);
  document.getElementById(`img${lastIdx}`).src = `https://royaleapi.github.io/cr-api-assets/cards/${id}.png`;
  document.getElementById(`e${lastIdx}`).innerText = card.e;
  s.classList.add('filled'); closeModal(); updateStats();
  tg.HapticFeedback.impactOccurred('medium');
}

function updateStats() {
  const d = deck.filter(c => c);
  if(!d.length) return;
  
  const atk = Math.min(100, (d.filter(c=>c.role==='win').length * 30) + (d.filter(c=>c.tags.includes('heavy')).length * 10));
  const def = Math.min(100, (d.filter(c=>c.tags.includes('building')).length * 25) + (d.filter(c=>c.role==='def').length * 15));
  const f2p = Math.max(0, 100 - d.reduce((acc, c) => acc + (c.r * 12), 0) / 1);
  
  setBar('atk', atk); setBar('def', def); setBar('f2p', f2p);
  setBar('syn', Math.min(100, d.length * 10));
}

function setBar(id, val) {
  document.getElementById(`b-${id}`).style.width = val + '%';
  document.getElementById(`v-${id}`).innerText = Math.round(val) + '%';
}

function analyze() {
  if(deck.includes(null)) return tg.showAlert("–ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ 8 —Å–ª–æ—Ç–æ–≤!");
  
  const d = deck;
  const avg = (d.reduce((a,b)=>a+b.e,0)/8).toFixed(1);
  const winCount = d.filter(c=>c.role==='win').length;
  const splashCount = d.filter(c=>c.tags.includes('splash')).length;
  const airCount = d.filter(c=>c.tags.includes('air')).length;
  const buildingCount = d.filter(c=>c.tags.includes('building')).length;
  const spellCount = d.filter(c=>c.role==='spell').length;
  const cycleCount = d.filter(c=>c.e <= 2).length;
  const champCount = d.filter(c=>c.r === 5).length;

  let emoji, title, text;
  const r = (arr) => arr[Math.floor(Math.random()*arr.length)];

  // –õ–û–ì–ò–ö–ê –ü–†–û–ñ–ê–†–ö–ò (30+ –í–ê–†–ò–ê–ù–¢–û–í)
  if (winCount === 0) {
    emoji = "ü§°"; title = "–ë–ï–ó–î–ê–†–ù–´–ô –ü–ê–¶–ò–§–ò–°–¢";
    text = r(["–£ —Ç–µ–±—è –Ω–æ–ª—å –≤–∏–Ω-–∫–æ–Ω–æ–≤. –¢—ã –ø–ª–∞–Ω–∏—Ä—É–µ—à—å –≤—ã–∏–≥—Ä–∞—Ç—å, –Ω–∞–¥–µ—è—Å—å –Ω–∞ –∏–Ω—Ñ–∞—Ä–∫—Ç –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞?","–¢—ã —Å–æ–±—Ä–∞–ª 8 –∫–∞—Ä—Ç –∑–∞—â–∏—Ç—ã. –≠—Ç–æ –Ω–µ –ö–ª—ç—à –†–æ—è–ª—å, —ç—Ç–æ –æ—á–µ—Ä–µ–¥—å –≤ –ú–§–¶.","–î–æ–±–∞–≤—å —Ö–æ—Ç—å –•–æ–≥–∞, –ø–∞—Ü–∏—Ñ–∏—Å—Ç —Ö—Ä–µ–Ω–æ–≤. –¢—ã –Ω–∏ –æ–¥–Ω—É –±–∞—à–Ω—é –Ω–µ —Å–Ω–µ—Å–µ—à—å."]);
  } else if (avg > 4.8) {
    emoji = "üêò"; title = "–¢–Ø–ñ–ï–õ–´–ô –°–õ–£–ß–ê–ô";
    text = r([`–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ ${avg}? –¢—ã —á—Ç–æ, –∞—Ä–∞–±—Å–∫–∏–π —à–µ–π—Ö, —á—Ç–æ–±—ã —Å—Ç–æ–ª—å–∫–æ —ç–ª–∏–∫—Å–∏—Ä–∞ —Ç—Ä–∞—Ç–∏—Ç—å?`,`–¢–≤–æ—è –¥–µ–∫–∞ –º–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –≤ –¥–µ—Ä–µ–≤–Ω–µ. –¢–µ–±—è –ø–µ—Ä–µ–µ–¥—É—Ç –æ–±—ã—á–Ω—ã–º–∏ —Å–∫–µ–ª–µ—Ç–∞–º–∏.`,`–ü–æ–∫–∞ —Ç—ã –ø–æ—Å—Ç–∞–≤–∏—à—å –æ–¥–Ω—É –∫–∞—Ä—Ç—É, –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫ —É—Å–ø–µ–µ—Ç –∂–µ–Ω–∏—Ç—å—Å—è –∏ –∑–∞–≤–µ—Å—Ç–∏ –¥–µ—Ç–µ–π.`]);
  } else if (buildingCount >= 3) {
    emoji = "üß±"; title = "–°–¢–†–û–ò–¢–ï–õ–¨-–ú–ê–ó–û–•–ò–°–¢";
    text = r(["–¢—Ä–∏ –∑–¥–∞–Ω–∏—è? –¢—ã —á—Ç–æ, —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–ª–ª–µ–¥–∂ –∑–∞–∫–∞–Ω—á–∏–≤–∞–ª?","–ü—Ä–æ—Ç–∏–≤ —Ç–µ–±—è –∏–≥—Ä–∞—Ç—å ‚Äî —ç—Ç–æ –∫–∞–∫ –≤ —Å—Ç–µ–Ω—É –≥–æ–ª–æ–≤–æ–π –±–∏—Ç—å—Å—è. –û—á–µ–Ω—å —Å–∫—É—á–Ω–æ.","–¢–≤–æ—è —Ç–∞–∫—Ç–∏–∫–∞ ‚Äî –∑–∞—Å—Ç—Ä–æ–∏—Ç—å—Å—è –∏ –ø–ª–∞–∫–∞—Ç—å? –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ."]);
  } else if (airCount >= 5) {
    emoji = "üéà"; title = "–í–û–ó–î–£–®–ù–´–ô –ó–ê–ú–û–ö";
    text = "–£ —Ç–µ–±—è –≤—Å—è –¥–µ–∫–∞ –≤ –≤–æ–∑–¥—É—Ö–µ. –û–¥–∏–Ω —ç–∫–∑–µ–∫—É—Ç–æ—Ä –∏–ª–∏ –æ—Ö–æ—Ç–Ω–∏–∫ ‚Äî –∏ —Ç–≤–æ–∏ –∫–∞—Ä—Ç—ã –ø–æ—Å—ã–ø—è—Ç—Å—è –∫–∞–∫ —Ç–≤–æ–∏ –Ω–∞–¥–µ–∂–¥—ã –Ω–∞ —Ç–æ–ø-1.";
  } else if (spellCount >= 4) {
    emoji = "ü™Ñ"; title = "–ì–ê–†–†–ò –ü–û–¢–¢–ï–†";
    text = "4 –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è? –¢—ã –ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–º–∞—Ö–∏–≤–∞–µ—à—å—Å—è —Ñ–∞–π–µ—Ä–±–æ–ª–æ–º –ø–æ –º—É—à–∫–µ—Ç–µ—Ä—É?";
  } else if (champCount >= 2) {
    emoji = "üíé"; title = "–ú–ê–ñ–û–†–ù–´–ô –°–ü–ê–ú";
    text = "–ó–∞–ø–∏—Ö–Ω—É–ª –≤—Å–µ—Ö —á–µ–º–ø–∏–æ–Ω–æ–≤ –≤ –æ–¥–Ω—É –¥–µ–∫—É? –ö–æ—à–µ–ª–µ–∫ –±–æ–ª—å—à–æ–π, –∞ –º–æ–∑–≥–æ–≤... –ª–∞–¥–Ω–æ, –ø—Ä–æ–º–æ–ª—á—É.";
  } else if (cycleCount >= 5 && avg < 2.8) {
    emoji = "üí¶"; title = "–ü–û–¢–ù–´–ô –ó–ê–î–†–û–¢";
    text = r(["–°—Ä–µ–¥–Ω–∏–π —ç–ª–∏–∫—Å–∏—Ä " + avg + ". –¢—ã –Ω–∞–∂–∏–º–∞–µ—à—å –Ω–∞ —ç–∫—Ä–∞–Ω —á–∞—â–µ, —á–µ–º –¥—ã—à–∏—à—å? –†–∞—Å—Å–ª–∞–±—å—Å—è.","–¢—ã –∏–∑ —Ç–µ—Ö, –∫—Ç–æ –¥–µ—Ñ–∞–µ—Ç –ì–æ–ª–µ–º–∞ –ª–µ–¥—è–Ω—ã–º –¥—É—Ö–æ–º –∏ —Ä–∞–¥—É–µ—Ç—Å—è? –ü–æ–º–æ–π —Ä—É–∫–∏, —Ç—ã –ø–µ—Ä–µ–ø–æ—Ç–µ–ª.","–¢–≤–æ—è –¥–µ–∫–∞ –≤–µ—Å–∏—Ç –º–µ–Ω—å—à–µ, —á–µ–º —Ç–≤–æ—è —Å–æ–≤–µ—Å—Ç—å –ø–æ—Å–ª–µ –ø–æ–±–µ–¥—ã –Ω–∞–¥ –Ω—É–±–æ–º."]);
  } else if (deck.some(c=>c.tags.includes('toxic'))) {
    emoji = "‚ò£Ô∏è"; title = "–¢–û–ö–°–ò–ß–ù–ê–Ø –ü–û–ú–û–ô–ö–ê";
    text = r(["–ê—Ä–±–∞–ª–µ—Ç, –∑–∞–º–æ—Ä–æ–∑–∫–∞, –∫–ª–æ–Ω... –° —Ç–æ–±–æ–π –≤ –¥–µ—Ç—Å—Ç–≤–µ –Ω–∏–∫—Ç–æ –Ω–µ –∏–≥—Ä–∞–ª?","–¢–≤–æ—è –¥–µ–∫–∞ ‚Äî –ø—Ä–∏—á–∏–Ω–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –ª—é–¥–∏ —É–¥–∞–ª—è—é—Ç –∏–≥—Ä—É. –ì–æ—Ä–¥–∏—à—å—Å—è —Å–æ–±–æ–π?","–§—É, —É–±–µ—Ä–∏ —ç—Ç–æ. –£ –º–µ–Ω—è —ç–∫—Ä–∞–Ω –¥–∞–∂–µ –∑–∞—à–∫–≤–∞—Ä–∏–ª—Å—è –æ—Ç —Ç–∞–∫–æ–≥–æ –±–∏–ª–¥–∞."]);
  } else if (splashCount === 0) {
    emoji = "üêú"; title = "–ö–û–†–ú –î–õ–Ø –ö–†–´–°";
    text = "–£ —Ç–µ–±—è –ù–û–õ–¨ —Å–ø–ª–µ—à-—É—Ä–æ–Ω–∞. –û–¥–Ω–∞ –∞—Ä–º–∏—è —Å–∫–µ–ª–µ—Ç–æ–≤ –∏–ª–∏ –±–∞–Ω–¥–∞ –≥–æ–±–ª–∏–Ω–æ–≤ ‚Äî –∏ —Ç–≤–æ–π '–º–µ–≥–∞-–±–∏–ª–¥' –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Ç—Ä—É—Ö—É.";
  } else if (winCount >= 3) {
    emoji = "ü§™"; title = "–®–ò–ó–û-–ü–£–®";
    text = "–•–æ–≥, –ì–∏–≥–∞–Ω—Ç –∏ –ö–∞–±–∞–Ω—ã –≤ –æ–¥–Ω–æ–π –¥–µ–∫–µ? –¢—ã –ª–∏–±–æ –≥–µ–Ω–∏–π, –ª–∏–±–æ –ø—Ä–æ—Å—Ç–æ —Ç—ã–∫–∞–ª –≤ —ç–∫—Ä–∞–Ω –∑–∞–∫—Ä—ã—Ç—ã–º–∏ –≥–ª–∞–∑–∞–º–∏.";
  } else if (avg >= 3.0 && avg <= 3.8 && winCount === 1 && spellCount === 2) {
    emoji = "ü§¥"; title = "–ì–ò–ì–ê–ß–ê–î –ë–ò–õ–î";
    text = r(["–°–ª–∏—à–∫–æ–º –∞–¥–µ–∫–≤–∞—Ç–Ω–æ. –ù–∞–≤–µ—Ä–Ω—è–∫–∞ —Å–ª–∏–∑–∞–ª —É —Ç–æ–ø–æ–≤, —Å–∞–º –±—ã —Ç–∞–∫–æ–µ –Ω–µ —Å–æ–±—Ä–∞–ª.","–ë–∏–ª–¥ –∏–¥–µ–∞–ª—å–Ω—ã–π. –ê–∂ –ø—Ä–æ—Ç–∏–≤–Ω–æ. –¢—ã, –Ω–µ–±–æ—Å—å, –∏ –∑—É–±—ã —á–∏—Å—Ç–∏—à—å –¥–≤–∞ —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å?","–° —Ç–∞–∫–æ–π –¥–µ–∫–æ–π –¥–∞–∂–µ —Ç—ã –¥–æ–ª–∂–µ–Ω –≤—ã–∏–≥—Ä—ã–≤–∞—Ç—å. –•–æ—Ç—è... –∑–Ω–∞—è —Ç–≤–æ–π —Å–∫–∏–ª–ª..."]);
  } else {
    // –í–ú–ï–°–¢–û "–í–ò–ù–ï–ì–†–ï–¢–ê" - –ï–©–ï 5 –ì–†–£–ë–´–• –í–ê–†–ò–ê–ù–¢–û–í
    const insults = [
      "–≠—Ç–æ –Ω–µ –∫–æ–ª–æ–¥–∞, —ç—Ç–æ –Ω–∞–±–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫. –¢—ã –≤ –∫—É—Ä—Å–µ, —á—Ç–æ –∫–∞—Ä—Ç—ã –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –≤–º–µ—Å—Ç–µ?",
      "–Ø –≤–∏–¥–µ–ª –º–Ω–æ–≥–æ —Ñ–∏–≥–Ω–∏, –Ω–æ —ç—Ç–æ ‚Äî —à–µ–¥–µ–≤—Ä –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏. –ß—Ç–æ —ç—Ç–æ –∑–∞ –º—É—Å–æ—Ä?",
      "–¢—ã —Å–æ–±—Ä–∞–ª –¥–µ–∫—É –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É '—á—Ç–æ –±—ã–ª–æ, —Ç–æ –∏ –ø–æ–ª—é–±–∏–ª–∞'? –ë–∞–ª–∞–Ω—Å–∞ –Ω–æ–ª—å, —Å–º—ã—Å–ª–∞ –µ—â–µ –º–µ–Ω—å—à–µ.",
      "–¢–≤–æ—è —Å–∏–Ω–µ—Ä–≥–∏—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è. –ö–∞—Ä—Ç—ã –≤ —Ç–≤–æ–µ–π –¥–µ–∫–µ –Ω–µ–Ω–∞–≤–∏–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –±–æ–ª—å—à–µ, —á–µ–º —è —Ç–≤–æ–π –±–∏–ª–¥.",
      "–ï—Å–ª–∏ —ç—Ç–æ —Ç–≤–æ—è –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–ª–æ–¥–∞ ‚Äî —É–¥–∞–ª—è–π –∏–≥—Ä—É. –°–µ—Ä—å–µ–∑–Ω–æ. –ù–µ –º—É—á–∞–π —Å–µ–±—è –∏ –ª—é–¥–µ–π."
    ];
    emoji = "ü§®"; title = "–ß–¢–û –≠–¢–û –ó–ê –ì*–í–ù–û?"; text = r(insults);
  }

  document.getElementById('res-emoji').innerText = emoji;
  document.getElementById('res-title').innerText = title;
  document.getElementById('res-text').innerText = text;
  document.getElementById('res-grid').innerHTML = d.map(c => `<img src="https://royaleapi.github.io/cr-api-assets/cards/${c.id}.png" style="width:100%; border-radius:8px">`).join('');
  document.getElementById('result').style.display = 'flex';
  tg.HapticFeedback.notificationOccurred('warning');
}
</script>
</body>
</html>
